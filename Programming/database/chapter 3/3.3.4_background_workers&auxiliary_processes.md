#### 3.3.4 Background Workers & Auxiliary Processes

- Autovacuum workers: Cleanup dead tuples
- WAL writer: Write-ahead log management
- Checkpointer: Periodic checkpoints
- Background writer: Async writes
- Statistics collector: Query stats
- Parallel query workers: Configured by max_worker_processes

- PostgreSQL runs background workers and auxiliary processes to handle maintenance and reliability tasks automatically, ensuring the database stays fast and consistent without blocking user queries. These processes work from first principles: databases must balance immediate query speed with long-term data integrity, crash recovery, and resource efficiency.

### Core Purpose

Databases accumulate "waste" from updates/deletes (dead tuples) and need constant logging for recovery, but writing everything synchronously would slow queries. Background processes offload these to dedicated workers, using shared memory and asynchronous I/O for non-blocking operation.

#### 6 Special PIDs (NOT Your SQL Workers!)

```text
â”Œâ”€ Postmaster ğŸ‘‘ forks these SPECIAL workers â”€â”€â”
â”‚ â”‚
â”œâ”€ Autovacuum #1 ğŸ§¹ â† Cleans dead tuples â”‚
â”œâ”€ WAL Writer ğŸ’¾ â† Saves changes safely â”‚
â”œâ”€ Checkpointer ğŸ›‘ â† Saves consistent state â”‚
â”œâ”€ Background Writer ğŸ“ â† Async disk writes â”‚
â”œâ”€ Stats Collector ğŸ“Š â† Tracks performance â”‚
â””â”€ Parallel #1-32 âš¡ â† Speed up complex queriesâ”‚
```

- Postmaster starts first when PostgreSQL runs. It waits on port 5432 for app connections. For each connection, it copies itself to make a new client process to handle that app's queries. If any process crashes, Postmaster restarts it.
  - Even simpler: Think of Postmaster as the boss who:
  - Answers the phone (port 5432) when apps call
  - Makes a copy of himself for each caller to talk to directly
  - Watches all workers and fixes problems if someone stops working

1. Autovacuum ğŸ§¹ #1
   Autovacuum workers (multiple launch automatically) scan tables for dead tuples (old row versions from MVCC updates/deletes) and clean them up to reclaim space and update statistics. Without it, tables bloat and queries slow down. Example: Like a hotel maid who empties trash from checked-out rooms (dead tuples) so new guests can use the space, running on a schedule to avoid peak hours.

- Key terms:

  - Dead tuple: Leftover row version after UPDATE/DELETE (MVCC keeps old versions visible to ongoing transactions).

  - MVCC (Multi-Version Concurrency Control): PostgreSQL's method to let readers never block writers by creating row versions.

  - Bloat: Wasted disk space from uncleared dead tuples.

2.
